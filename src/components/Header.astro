---
import { Button } from "@/components/ui/button";
import Logo from "@/components/Logo.astro";

const navItems = [
    { href: "#inicio", label: "Inicio" },
    { href: "#sobre-mi", label: "Sobre mí" },
    { href: "#proyectos", label: "Proyectos" },
    { href: "#habilidades", label: "Habilidades" },
];
---

<header
    class="fixed top-0 left-0 right-0 z-50 px-6 py-4 backdrop-blur-md bg-background/80 border-b border-border/50"
>
    <nav class="max-w-7xl mx-auto flex items-center justify-between">
        <!-- Logo -->
        <Logo />

        <!-- Navigation Links -->
        <div class="hidden md:flex items-center gap-8">
            {
                navItems.map((item) => (
                    <a
                        key={item.href}
                        href={item.href}
                        class="relative text-foreground hover:text-primary transition-colors"
                        data-nav={item.href.substring(1)}
                    >
                        {item.label}
                    </a>
                ))
            }
        </div>

        <!-- CTA Button -->
        <Button
            variant="default"
            className="bg-primary hover:bg-primary/90 text-primary-foreground rounded-full px-6"
        >
            Descargar CV
        </Button>
    </nav>
</header>

<script>
    const sections = document.querySelectorAll("section[id]");
    const navLinks = document.querySelectorAll("a[data-nav]");

    const observer = new IntersectionObserver(
        (entries) => {
            entries.forEach((entry) => {
                const id = entry.target.getAttribute("id");
                const link = document.querySelector(`a[data-nav='${id}']`);

                if (entry.isIntersecting) {
                    navLinks.forEach((l) => {
                        l.classList.remove("text-primary");
                        l.querySelector("div")?.remove();
                    });

                    link.classList.add("text-primary");

                    // Añadir subrayado animado
                    const underline = document.createElement("div");
                    underline.className =
                        "absolute -bottom-1 left-0 right-0 h-0.5 bg-primary rounded-full animate-scale-in";
                    link.appendChild(underline);
                }
            });
        },
        { threshold: 0.6 },
    );

    sections.forEach((section) => observer.observe(section));
</script>
